def changelogFooter = """
### Support

If you have any issues with this mod, please report them on our [Issue Tracker](https://go.ftb.team/support-mod-issues)

"""

ext.createChangelog = (Project project) -> {
    assert project != null
    assert project.version != null

    def changelogFile = project.rootProject.file('CHANGELOG.md')
    if (!changelogFile.exists()) {
        return "No changelog provided"
    }

    def changelogData = changelogFile.text as String
    def changelogLines = changelogData.split('\n')

    def changelogOutput = ""
    def inVersion = false

    for (def line : changelogLines) {
        if (line.startsWith("## ")) {
            def wasInVersion = inVersion
            inVersion = line.contains(project.version.toString())

            if (wasInVersion && !inVersion) {
                break
            }
        }

        if (inVersion) {
            changelogOutput += line + '\n'
        }
    }

    return changelogOutput.trim() + '\n' + changelogFooter
}
